{% sw_extends '@Storefront/storefront/component/payment/payment-method.html.twig' %}

{% block component_payment_method_description %}
    {# @var \Swag\PayPal\Checkout\SPBCheckout\SPBMarksData spbCheckoutMarksData #}
    {% set spbCheckoutMarksData = page.extensions[constant('Swag\\PayPal\\Checkout\\SPBCheckout\\SPBMarksSubscriber::PAYPAL_SMART_PAYMENT_MARKS_DATA_EXTENSION_ID')] %}

    {% if spbCheckoutMarksData and spbCheckoutMarksData.paymentMethodId is same as(payment.id) %}
        <div class="payment-method-description"
             data-swag-paypal-marks="true"
             data-swag-pay-pal-marks-options="{{ spbCheckoutMarksData|json_encode }}">
        </div>
        {% if payment.translated.description %}
            <p>{{ payment.translated.description|raw }}</p>
        {% endif %}
    {% else %}
        {{ parent() }}
    {% endif %}

    {# @var \Swag\PayPal\Checkout\Plus\PlusData payPalPlusData #}
    {# @deprecated tag:v6.0.0 - Will be removed without replacement #}
    {% set payPalPlusData = page.extensions[constant('Swag\\PayPal\\Checkout\\Plus\\PlusSubscriber::PAYPAL_PLUS_DATA_EXTENSION_ID')] %}

    {% if payPalPlusData and payPalPlusData.approvalUrl and payPalPlusData.paymentMethodId is same as(context.paymentMethod.id) and payPalPlusData.paymentMethodId is same as(payment.id) %}
        <div class="d-none"
             data-swag-paypal-payment-wall="true"
             data-swag-pay-pal-plus-payment-wall-options="{{ payPalPlusData|json_encode }}">
        </div>
        <div id="ppplus"></div>
    {% endif %}

    {# @var \Swag\PayPal\Installment\Banner\BannerData installmentBanner #}
    {% set installmentBanner = page.extensions[constant('Swag\\PayPal\\Installment\\Banner\\InstallmentBannerSubscriber::PAYPAL_INSTALLMENT_BANNER_DATA_EXTENSION_ID')] %}

    {% if installmentBanner is not null and installmentBanner.paymentMethodId is same as(payment.id) %}
        <div data-swag-paypal-installment-banner="true"
             data-swag-pay-pal-installment-banner-options="{{ installmentBanner|json_encode }}"
             data-swag-paypal-installment-banner-is-confirm="true">
        </div>
    {% endif %}
{% endblock %}


{% block component_payment_method_label %}
    {{ parent() }}

    {# @var \Swag\PayPal\Checkout\ACDC\ACDCCheckoutFieldData acdcFieldData #}
    {% set acdcFieldData = page.extensions[constant('Swag\\PayPal\\Util\\Lifecycle\\Method\\ACDCMethodData::PAYPAL_ACDC_FIELD_DATA_EXTENSION_ID')] %}
    {# @var \Swag\PayPal\Checkout\PUI\PUIFraudNetData acdcFieldData #}
    {% set puiFraudnetData = page.extensions[constant('Swag\\PayPal\\Checkout\\PUI\\PUISubscriber::PAYPAL_PUI_FRAUDNET_PAGE_EXTENSION_ID')] %}

    {% if acdcFieldData and acdcFieldData.paymentMethodId is same as(payment.id) %}
        {% block swag_paypal_acdc_form %}
            <div id="swag-paypal-acdc-form" class="d-none">
                <div class="row">
                    <div class="col-sm-12">
                        <label class="d-none"
                               for="swag-paypal-acdc-form-cardnumber">{{ "paypal.acdc.cardNumber"|trans }}</label>
                        <div class="form-control"
                             id="swag-paypal-acdc-form-cardnumber"
                             data-placeholder="{{ "paypal.acdc.cardNumber"|trans }}"
                        ></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <label class="d-none"
                               for="swag-paypal-acdc-form-expiration">{{ "paypal.acdc.expiration"|trans }}</label>
                        <div class="form-control"
                             id="swag-paypal-acdc-form-expiration"
                             data-placeholder="{{ "paypal.acdc.expiration"|trans }}"
                        ></div>
                    </div>
                    <div class="col-sm-6">
                        <label class="d-none" for="swag-paypal-acdc-form-cvv">{{ "paypal.acdc.cvv"|trans }}</label>
                        <div class="form-control"
                             id="swag-paypal-acdc-form-cvv"
                             data-placeholder="{{ "paypal.acdc.cvv"|trans }}"
                        ></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label class="d-none"
                               for="swag-paypal-acdc-form-cardholder">{{ "paypal.acdc.cardholderName"|trans }}</label>
                        <input type="text"
                               required
                               form="confirmOrderForm"
                               class="form-control"
                               id="swag-paypal-acdc-form-cardholder"
                               placeholder="{{ "paypal.acdc.cardholderName"|trans }}"
                               value="{{ acdcFieldData.cardholderData.cardholderName }}"
                        />
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label class="d-none" for="swag-paypal-acdc-form-zip">{{ "paypal.acdc.zip"|trans }}</label>
                        <input type="text"
                               required
                               form="confirmOrderForm"
                               class="form-control"
                               id="swag-paypal-acdc-form-zip"
                               placeholder="{{ "paypal.acdc.zip"|trans }}"
                               value="{{ acdcFieldData.cardholderData.billingAddress.postalCode }}"
                        />
                    </div>
                </div>
            </div>
        {% endblock %}

    {% elseif puiFraudnetData and puiFraudnetData.paymentMethodId is same as(payment.id) and puiFraudnetData.paymentMethodId is same as(context.paymentMethod.id) %}

        {% block swag_paypal_pui_customer_data_form %}
            {% set birthdayName = constant('Swag\\PayPal\\Checkout\\PUI\\Service\\PUICustomerDataService::PUI_CUSTOMER_DATA_BIRTHDAY') %}
            {% set phoneNumberName = constant('Swag\\PayPal\\Checkout\\PUI\\Service\\PUICustomerDataService::PUI_CUSTOMER_DATA_PHONE_NUMBER') %}

            {% block swag_paypal_pui_customer_data_form_phone_number %}
                {% if not page.order.billingAddress.phoneNumber and not context.customer.activeBillingAddress.phoneNumber %}
                    <div class="form-row">
                        <div class="form-group col-12">

                            {% block component_address_form_phone_number_label %}
                                <label class="form-label"
                                       for="{{ phoneNumberName }}">
                                    {{ "address.phoneNumberLabel"|trans|sw_sanitize }}{{ "general.required"|trans|sw_sanitize }}
                                </label>
                            {% endblock %}

                            {% block component_address_form_phone_number_input %}
                                <input type="text"
                                       class="form-control"
                                       id="{{ phoneNumberName }}"
                                       placeholder="{{ "address.phoneNumberPlaceholder"|trans|striptags }}"
                                       name="{{ phoneNumberName }}"
                                       form="confirmOrderForm"
                                       required="required">
                            {% endblock %}

                        </div>
                    </div>
                {% endif %}
            {% endblock %}

            {% block swag_paypal_pui_customer_data_form_birthday %}
                {% if not context.customer.birthday %}
                    {% block swag_paypal_pui_customer_data_form_birthday_label %}
                        <label for="{{ birthdayName }}">
                            {{ "account.personalBirthdayLabel"|trans|sw_sanitize }}{{ "general.required"|trans|sw_sanitize }}
                        </label>
                    {% endblock %}

                    {% block swag_paypal_pui_customer_data_form_birthday_selects %}
                    <div class="form-row">

                        {% block swag_paypal_pui_customer_data_form_birthday_select_day %}
                            <div class="form-group col-4">
                                <select id="{{ birthdayName }}"
                                        name="{{ birthdayName }}[day]"
                                        class="custom-select"
                                        form="confirmOrderForm"
                                        required="required">
                                    <option selected="selected"
                                            disabled="disabled"
                                            value="">
                                        {{ "account.personalBirthdaySelectDay"|trans|sw_sanitize }}
                                    </option>
                                    {% for day in range(1, 31) %}
                                        <option value="{{ day }}">{{ day }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        {% endblock %}

                        {% block swag_paypal_pui_customer_data_form_birthday_select_month %}
                            <div class="form-group col-4">
                                <select name="{{ birthdayName }}[month]"
                                        class="custom-select"
                                        form="confirmOrderForm"
                                        required="required">
                                    <option selected="selected"
                                            disabled="disabled"
                                            value="">
                                        {{ "account.personalBirthdaySelectMonth"|trans|sw_sanitize }}
                                    </option>
                                    {% for month in range(1, 12) %}
                                        <option value="{{ month }}">{{ month }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        {% endblock %}

                        {% block swag_paypal_pui_customer_data_form_birthday_select_year %}
                            <div class="form-group col-4">
                                {% set currentYear = "now"|date('Y') %}
                                {% set startYear = currentYear - 120 %}

                                <select name="{{ birthdayName }}[year]"
                                        class="custom-select"
                                        form="confirmOrderForm"
                                        required="required">
                                    <option selected="selected"
                                            disabled="disabled"
                                            value="">
                                        {{ "account.personalBirthdaySelectYear"|trans|sw_sanitize }}
                                    </option>
                                    {% for year in range(currentYear, startYear) %}
                                        <option value="{{ year }}">{{ year }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        {% endblock %}

                    </div>
                {% endblock %}
                {% endif %}
            {% endblock %}
        {% endblock %}
    {% endif %}
{% endblock %}
